
<div id="main" class="content-page">
    <div class="page-content-wrapper">
        <div class="container x_panel no-border">
            <br>
            <div class="">
                <div class="panel panel-default" style="border: 1px solid #eee;">
                    <div class="panel-body" style="padding:0px 0 10px 0;">
                        <form class="form-horizontal form-label-left" *ngIf="page" novalidate>
                            <div class="col-xs-12">
                                <br />
                                <div class="pull-right" id="tdExports" *ngIf="tdExports">
                                    <ul class="list-inline">
                                        <li class="no-padding">
                                            <i class="fa fa-envelope-o fa-bg-lg bg-blue" aria-hidden="true" id="imgMail" title="Send mail" style="cursor:pointer;" (click)="onSendMailIconClick($event)"></i>&nbsp;
                                        </li>
                                        <li class="no-padding">
                                            <i class="fa fa-print fa-bg-lg bg-blue" aria-hidden="true" id="imgPrint" title="Print" style="cursor:pointer;" (click)="onPrintClick($event)"></i>&nbsp;
                                        </li>
                                        <li class="no-padding">
                                            <i class="fa fa-file-excel-o fa-bg-lg bg-blue" aria-hidden="true" id="imgExcel" style="cursor:pointer;" title="Excel Format" (click)="onExportToExcelClick($event)"></i>&nbsp;
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-sm-6 col-md-4">Org Group ID </label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <label *ngIf="blnShowOrgGroupLabel" class="control-label lbl-left">{{orgGrpIDData}}</label>
                                        <atpar-select [options]="lstOrgGroups" [id]="'ddllstOrgGroups'" [required]="true" [(ngModel)]="selectedOrgGroupId" [ngModelOptions]="{standalone: true}" filter="filter" *ngIf="blnShowOrgGroupsDropdown" (onChange)="ddlOrgGrpIdChanged()"></atpar-select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-sm-6 col-md-4">Business Unit / Company</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <atpar-select [options]="lstFilteredBUnits" [id]="'ddllstBunit'" [required]="true" [(ngModel)]="selectedBunit" [ngModelOptions]="{standalone: true}" filter="filter" (onChange)="ddl_ChangeBunitChanged()"></atpar-select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-md-4 col-sm-6">Dept ID</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <atpar-text [(ngModel)]="selectedDeptId" [name]="txtDeptId" [id]="'txtDeptId'" [validations]="'mandatory'" [ngModelOptions]="{standalone: true}"></atpar-text>
                                    </div>
                                </div>
                                <div style="clear:both;"></div>
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-sm-6 col-md-4">Cart ID / Par Location</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">   
                                        <atpar-ac-server [(ngModel)]="selectedCartId" [id]="'txtSelectedCartId'" [ngModelOptions]="{standalone: true}" [mandatory]="'true'" [suggestions]="lstFilteredCartIds" (completeMethod)="fillCartIdsAuto($event)"></atpar-ac-server>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-md-4 col-sm-4">From Date</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <p-calendar [showIcon]="true" [id]="'FromDatePicker'" [(ngModel)]="fromDate" [monthNavigator]="true" [yearNavigator]="true" yearRange="1950:2050" [placeholder]="'From Date'" [dateFormat]="'mm/dd/yy'" [readonlyInput]="true" [required]="true" [ngModelOptions]="{standalone: true}"></p-calendar>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-md-4 col-sm-4">To Date</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <p-calendar [showIcon]="true" [id]="'ToDatePicker'" [(ngModel)]="toDate" [monthNavigator]="true" [yearNavigator]="true" yearRange="1950:2050" [placeholder]="'To Date'" [readonlyInput]="true" [dateFormat]="'mm/dd/yy'" [ngModelOptions]="{standalone: true}" [required]="true"></p-calendar>
                                    </div>
                                </div>
                                <div style="clear:both"></div>
                                <div class="col-xs-12 col-sm-12 col-md-4 form-group">
                                    <label for="" class="control-label col-xs-12 col-sm-6 col-md-4">Count Frequency</label>
                                    <div class="col-xs-12 col-sm-6 col-md-8">
                                        <atpar-select [options]="lstCountFrequency" [id]="'ddllstCountFrequency'" [(ngModel)]="selectedCouontFrequency" [ngModelOptions]="{standalone: true}" filter="filter" (onChange)="CountFreqChanged()"></atpar-select>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-4  form-group">
                                    <button class="btn btn-purple sbtn" (click)="btnGo_Click()">Go &nbsp; <i class="fa fa-arrow-right"></i></button>
                                </div>
                                <div style="clear:both"></div>
                                <div class="col-xs-12 col-sm-12 col-md-4  form-group">
                                    <span class="text-danger mandatory">*</span>
                                    <span>Cart ID/Par Location or Dept ID is Mandatory</span>
                                    <br />
                                    <span class="text-danger mandatory">*</span>
                                    <strong><span>Note : </span></strong>
                                    <span class="text-primary">Search data is case sensitive</span>
                                </div>                            
                           </div>  
                        </form>

                        <br />

                        <div class="col-xs-12 table-responsive" *ngIf="isVisible">
                            <div class="container no-scrl">
                                <span class="pull-left" *ngIf="isLblVisible">Cart Optimization Report between {{lblFromDate}} and {{lblToDate}}</span>
                                <br />
                                <span class="pull-left" *ngIf="isLblBunitVisible">{{lblBunitCart}}</span>
                                <br />
                                <atpar-datatable [value]="lstDBData"  
                                                 [paginator]="false"                                                 
                                                  expandableRows="true" 
                                                  [responsive]="true"                                                 
                                                 (filteredData)="onChargesFilterData($event)"
                                                 [style]="{'width':'100%'}"
                                                 scrollable="true">                                   
                                    <p-footerColumnGroup>
                                        <p-row >                                         
                                            <p-column footer=""></p-column>
                                            <p-column footer="Current Value($)"  styleClass="text-right" colspan="2"></p-column>
                                            <p-column footer={{lblCurrentval}} styleClass="text-right"></p-column>
                                            <p-column footer=""></p-column>
                                            <p-column footer="Recommended Value($)" styleClass="text-right" colspan="2"></p-column>
                                            <p-column footer={{lblRecommendedVal}} styleClass="text-right"></p-column>
                                            <p-column footer="" ></p-column>
                                            <p-column footer=""></p-column>
                                            <p-column footer="Net reduction($)" styleClass="text-right" colspan="2"></p-column>
                                            <p-column footer={{lblNetReductionVal}} styleClass="text-right"></p-column>
                                            <p-column footer="" ></p-column>
                                            <p-column footer="" ></p-column>                                                                                
                                        </p-row>
                                    </p-footerColumnGroup>
                                    <p-column [style]="{'width':'80px', 'text-align':'center'}" header="Select" *ngIf="isVisibleChkBox">
                                        <template pTemplate="filter" let-col>
                                            <ul class="list-inline li-all-none">
                                                <li>
                                                    <span (click)="checkAll()" style="cursor:pointer">All</span>
                                                </li> |
                                                <li>
                                                    <span (click)="unCheckAll()" style="cursor:pointer">None</span>

                                                </li>
                                            </ul>
                                        </template>
                                        <template let-ven="rowData" pTemplate type="body">
                                            <atpar-switch [(ngModel)]="ven.checkvalue" (change)="selectedRow(ven,$event)"></atpar-switch>
                                        </template>
                                    </p-column>
                                    <p-column field="ITEM_ID" header="Item ID" [filter]="true" sortable="custom" (sortFunction)="customSort($event)" filterPlaceholder="Search" [style]="{'width':'140px'}"></p-column>
                                    <p-column field="CUST_ITEM_ID" header="Custom Item NO" sortable="custom" [filter]="true" (sortFunction)="customSort($event)" filterPlaceholder="Search" [style]="{'width':'140px'}"></p-column>
                                    <p-column field="DESCR" header="Description" sortable="custom" [filter]="true" (sortFunction)="customSort($event)" filterPlaceholder="Search" [style]="{'width':'155px'}"></p-column>
                                    <p-column field="COMPARTMENT" header="Compartment" sortable="custom" (sortFunction)="customSort($event)" [filter]="true" filterPlaceholder="Search" [style]="{'width':'100px'}"></p-column>
                                    <p-column field="PRICE" header="Price($)" sortable="custom" [filter]="true" (sortFunction)="customSort($event)" filterPlaceholder="Search" styleClass="text-right" [style]="{'width':'90px'}"></p-column>
                                    <p-column field="PAR_QTY" header="Par Qty" sortable="custom" [filter]="true" (sortFunction)="customSort($event)" styleClass="text-right" [style]="{'width':'90px'}" filterPlaceholder="Search"></p-column>
                                    <p-column field="UOM" header="UOM" sortable="custom" [filter]="true" (sortFunction)="customSort($event)" filterPlaceholder="Search" [style]="{'width':'70px'}"></p-column>
                                    <p-column field="MAX_USAGE" header="Max Usage" sortable="custom" (sortFunction)="customSort($event)" styleClass="text-right"  [style]="{'width':'85px'}" [filter]="true" filterPlaceholder="Search"></p-column>
                                    <p-column field="MIN_USAGE" header="Min Usage" sortable="custom" (sortFunction)="customSort($event)"  styleClass="text-right" [style]="{'width':'85px'}" [filter]="true" filterPlaceholder="Search"></p-column>
                                    <p-column field="AVG_USAGE" header="Avg Usage" sortable="custom" (sortFunction)="customSort($event)" styleClass="text-right" [style]="{'width':'85px'}" [filter]="true" filterPlaceholder="Search"></p-column>
                                    <p-column field="TOTAL_USAGE" header="Total Usage" sortable="custom" (sortFunction)="customSort($event)" styleClass="text-right" [style]="{'width':'90px'}" [filter]="true" filterPlaceholder="Search"></p-column>
                                    <p-column field="OrderQty" header="OrderQty" sortable="custom" (sortFunction)="customSort($event)" styleClass="text-right" [filter]="true" [style]="{'width':'85px'}" filterPlaceholder="Search"></p-column>
                                    <p-column field="RECOMMENDED_PAR" header="Reco. par / day * count freq." (sortFunction)="customSort($event)" styleClass="text-right" sortable="custom" [style]="{'width':'173px'}" [filter]="true" filterPlaceholder="Search"></p-column>
                                    <p-column field="RECOMMENDED_PAR_QTY"  [style]="{'width':'90px'}" *ngIf="isVisibleEdiTxt">
                                        <template let-ven="rowData" pTemplate type="body">
                                            <atpar-text-grid [id]="ven.Sno"
                                                              [name]="txtRecommendedPar"
                                                              [(ngModel)]="ven.RECOMMENDED_PAR_QTY" 
                                                              [validations]="'numeric,max=15'"
                                                              [ngModelOptions]="{standalone: true}"></atpar-text-grid>

                                        </template>
                                    </p-column>
                                </atpar-datatable>
                            </div>
                        </div>
                        <div style="clear:both"></div>
                        <br />
                        <div class="col-xs-12 col-sm-6 col-sm-offset-5 col-md-4 col-md-offset-5" *ngIf="isVisibleBtnUpdate">
                            <button class="btn btn-purple sbtn" (click)="btnUpdate_Click()">Update &nbsp;<i class="fa fa-check"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<atpar-growl [value]="growlMessage" sticky="sticky"></atpar-growl>

<mail-dialog header="Enter Recipient`s Email Address" [width]="450" (onClose)="closeMailPopup()" [(visible)]="isMailDialog" [responsive]="true" showEffect="fade" [modal]="true">
    <div class="ui-grid ui-grid-responsive ui-fluid">
        <div class="row">
            <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3" style="margin-top:2%;margin-right:-2%">
                <span style="font-weight:600">To : </span>
            </div>
            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
                <atpar-text [(ngModel)]="toMailAddr" [name]="txtToMailAddr" [id]="'txtToMailAddr'"></atpar-text>
            </div>
            <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3">
                <span><button class="btn btn-purple sbtn" (click)="onSendMailClick()">Send &nbsp;<i class="fa fa-share-square-o" aria-hidden="true"></i></button> </span>
            </div>
        </div>
    </div>
</mail-dialog>

<style>   
    .modal-content {
            top: 50% !important;
        }
</style>